<HTML>
<HEAD>
<TITLE>Internet class library</TITLE>
</HEAD>
<BODY>

<CENTER>
<H4>レコード型プロトコル支援</H4>
</CENTER>

<HR NOSHADE>

<P>
属性と値の組を文字列により表現したレコード型データをやり取りするプロトコ
ルの実装を支援するための以下の機能を備えたフレームワークを提供するもので
ある。
<UL>
<LI> 不定個の属性を持つレコードの生成と操作<BR>
不定個の属性を持つレコードの定義、および特定の属性の値の取り出し
操作を行う。
<LI> レコードのエンコード / デコード<BR>
レコードと文字列表現の間の相互変換を行う。
</UL>
</P>

<P>
この機能はフレームワークとして、次のように利用される。
<UL>
<LI>クライアントプログラムからサーバへコマンドデータを送信する機能を実装する。<BR>
プロトコルを実装するクラスは各コマンドに対応したインタフェースを
提供し、その引数によってコマンドに必要なパラメータを指定できるよ
うにする。
<LI> 送信したコマンドに対するレスポンスデータを受信する機能を実装する。<BR>
レスポンスにはステータスコードと文字列が含まれる。上のコマンドを送
信するインタフェースの返り値としてステータスコードをを受け取るこ
とを可能にし、文字列を得るためのインタフェースは別にあるものとする。
</UL>
</P>

<P>
これらの中で、フレームワークとしてここで提供できる機能は以下の通りである。
<UL>
<LI> コマンドおよびパラメータからコマンドデータを生成する機能<BR>
レコードのエンコード操作に相当する。
<LI> レスポンスデータからステータスコードおよび文字列を抽出する機能<BR>
レコードのデコード操作に相当する。
<LI> レスポンスデータの文字列を獲得する機能
</UL>
</P>

<P>
コマンドデータおよびレスポンスデータのフォーマットはプロトコル固
有のものである。したがって、レコードのエンコード、デコード機能を実現する
には、そのデータフォーマットを与える手段が必要である。<BR>
インタネット上で利用されている主要なプロトコルでは、実装を考慮し、解析が
容易となるようなフォーマットが規定されているという特性を利用した実現を行
なう。具体的には、ある区切り文字を規定し、その区切り文字を含む可能性のあ
るデータは最後の位置にあるという形式である。<BR>
したがって、フォーマットをデータの並びを属性名と区切り文字からなる文字列
で表現し、そのフォーマットを解析することによってエンコード、デコードを行
なうという実現を行なう。なお、属性名には英数字と '<code>_</code>' だけを利用す
るものとする。また、コマンドとステータスコードには、それぞれ 
<code>COMMAND</code>、<code>STATUS</code> という属性名を予約する。
したがってフォーマットは、次のようなものが与えられるものとする。
<P>
<PRE>    COMMAND PARAM:VALUE\r\n</PRE>
<P>
このフォーマットに対して、
<P>
<PRE>
    COMMAND=MAIL
    PARAM=FROM
    VALUE=foo@bar.co.jp
</PRE>
<P>
という値が各属性に設定されている場合、レコードをエンコードした結果として、
<P>
<PRE>    MAIL FROM:foo@bar.co.jp</PRE>
<P>
という文字列データが得られる。
<P>
またフォーマットに、
<P>
<PRE>    STATUS MESSAGE</PRE>
<P>
を指定し、これを利用して、
<P>
<PRE>    250 ok</PRE>
<P>
というレスポンスデータをデコードすると、
<P>
<PRE>
    STATUS=250
    MESSAGE=ok
</PRE>
<P>
というように各属性の値がレコードに設定される。なお、これらのフォーマット
文字列は、レコードのオブジェクトの生成時に指定する。
<UL> 
<LI> <A HREF="prot_record.html"><B>ProtocolRecord</B> クラス</A>
</UL>
</P>

<P>
利用するサブプログラム
<UL>
<LI> クラスライブラリ
  <UL>
  <LI> <B>Dictionary</B> クラス
  </UL>
</UL>
</P>

<HR NOSHADE>

</BODY>
</HTML>
